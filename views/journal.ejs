<%- include('partials/header', { pageTitle: 'Tous les articles' }) %>

    <h1>Tous les articles</h1>
    <nav>
        <% if (locals.username) { %>
            <a href="/journal/nouvelle">Ajouter une entrée</a> | 
        <% } %>
        <a href="/">Retour à l'accueil</a>
    </nav>

    <%# On boucle sur le tableau 'articles' qu'on a reçu du serveur %>
    <% articles.forEach(article => { %>
        <article>
            <%# AJOUT : On affiche l'image seulement si elle existe %>
            <% if (article.image_filename) { %>
                <img src="/uploads/<%= article.image_filename %>" alt="<%= article.title %>" style="max-width: 100%; height: auto; border-radius: 5px; margin-bottom: 1rem;">            
            <% } %>
            <h2>
                <a href="/entree/<%= article.id %>"><%= article.title %></a>
            </h2>
            <p><%= article.content.substring(0, 200) %>...</p> 
            <small>Publié le: <%= new Date(article.publication_date).toLocaleString('fr-FR') %></small>
            <br><br>
            <a href="/entree/<%= article.id %>/edit">Modifier</a>
            <form action="/entree/<%= article.id %>/delete" method="POST" style="display: inline; margin-left: 10px;">
                <button type="submit">Supprimer</button>
            </form>
        </article>
        <hr>
    <% }); %>

<%- include('partials/footer') %>