<%- include('partials/header', { pageTitle: 'Accueil' }) %>

<h1>Mon Carnet de Stage</h1>
<p>Bienvenue sur ce site créé pour documenter mon stage à l'étranger. Découvrez ci-dessous les entrées les plus récentes du journal de bord.</p>

<nav>
    <% if (locals.username) { %>
        <a href="/journal/nouvelle">Ajouter une entrée</a> | 
    <% } %>
    <a href="/journal">Voir tout le journal</a>
</nav>

<hr>
<h2>Les dernières entrées</h2>

<% articles.forEach(entry => { %>
    <article>
        <% if (entry.coverImage) { %>
            <img src="<%= entry.coverImage %>" alt="<%= entry.title %>" style="max-width: 100%; height: auto; border-radius: 5px; margin-bottom: 1rem;">
        <% } %>
        <h2><a href="/entree/<%= entry.id %>"><%= entry.title %></a></h2>
        <small>Publié le: <%= new Date(entry.publication_date).toLocaleString('fr-FR') %></small>
        <p><%= entry.content.substring(0, 350) %>... <a href="/entree/<%= entry.id %>">Lire la suite</a></p>
        
        <% if (locals.username) { %>
            <div class="actions">
                <a href="/entree/<%= entry.id %>/edit">Modifier</a>
                <form action="/entree/<%= entry.id %>/delete" method="POST">
                    <button type="submit">Supprimer</button>
                </form>
            </div>
        <% } %>
    </article>
<% }); %>

<%- include('partials/footer') %>