<%- include('partials/header', { pageTitle: pageTitle }) %>

<h1><%= t('homepage.title') %></h1>
<p><%= t('homepage.welcome') %></p>

<div style="display: flex; gap: 1rem; margin: 1.5rem 0;">
    <% if (locals.username) { %>
        <a href="/journal/nouvelle" class="btn">
            <i class="fas fa-plus-circle"></i> <%= t('journal.add_entry') %>
        </a>
    <% } %>
    
    <a href="/journal" class="btn btn-secondary">
        <i class="fas fa-list"></i> <%= t('journal.view_all') %>
    </a>
</div>

<hr>
<h2><%= t('general.latest_entries') %></h2>

<div class="entries-grid">
    <% articles.forEach(entry => { %>
        <article class="entry-card">
            <% if (entry.coverImage) { %>
                <a href="/entree/<%= entry.id %>" class="card-image-link">
                    <img src="<%= entry.coverImage %>" alt="<%= entry.title %>" class="cover-image" loading="lazy">
                </a>
            <% } %>
            
            <div class="card-body">
                <h2>
                    <% if (entry.is_pinned) { %>
                        <i class="fas fa-thumbtack" style="color: var(--c-primary); font-size: 0.8em; margin-right: 5px;" title="Épinglé"></i>
                    <% } %>

                    <a href="/entree/<%= entry.id %>"><%= entry.title %></a>
                    
                </h2>
                <div style="font-size: 0.85rem; color: var(--c-text-light); margin-bottom: 10px;">
                    <i class="far fa-calendar-alt"></i> <%= new Date(entry.publication_date).toLocaleDateString(i18n.language) %>
                    &nbsp; | &nbsp;
                    <i class="far fa-clock"></i> <%= entry.readingTime %> <%= t('general.min_read') %>
                </div>
                
                <% if (entry.tags && entry.tags.length > 0) { %>
                    <div class="tags-list">
                        <% entry.tags.forEach(tag => { %>
                            <a href="/tags/<%= tag %>" class="tag-item"><%= tag %></a>
                        <% }); %>
                    </div>
                <% } %>
                
                <p><%= entry.excerpt %>... <a href="/entree/<%= entry.id %>"><%= t('journal.read_more') %></a></p>
                
                <% if (locals.username) { %>
                    <div class="actions">
                        <a href="/entree/<%= entry.id %>/edit"><%= t('journal.edit') %></a>
                        <form action="/entree/<%= entry.id %>/delete" method="POST" 
                              data-confirm="<%= t('admin_page.delete_confirm', 'Voulez-vous vraiment supprimer cette entrée ?') %>" 
                              style="display: inline;">
                            <button type="submit"><%= t('journal.delete') %></button>
                        </form>
                    </div>
                <% } %>
            </div>
        </article>
    <% }); %>
</div>

<%- include('partials/footer') %>