<%- include('partials/header', { pageTitle: pageTitle }) %>

<h1><%= pageTitle %></h1> <%# Le titre est déjà traduit via server.js %>

<% if (articles.length > 0) { %>
    <p><%= t('search.results_count') %> : <%= articles.length %></p>
    <hr>
    <div class="entries-grid">
        <% articles.forEach(entry => { %>
            <article class="entry-card">
                <% if (entry.coverImage) { %>
                    <a href="/entree/<%= entry.id %>" class="card-image-link">
                        <img src="<%= entry.coverImage %>" alt="<%= entry.title %>" class="cover-image">
                    </a>
                <% } %>
                <div class="card-body">
                    <h2><a href="/entree/<%= entry.id %>"><%= entry.title %></a></h2>
                    <small><%= t('journal.published_on') %>: <%= new Date(entry.publication_date).toLocaleString(i18n.language) %></small>
                    
                    <%# Affiche les tags (cliquables) %>
                    <% if (entry.tags && entry.tags.length > 0) { %>
                        <div class="tags-list">
                            <% entry.tags.forEach(tag => { %>
                                <a href="/tags/<%= tag %>" class="tag-item"><%= tag %></a>
                            <% }); %>
                        </div>
                    <% } %>
                    
                    <p><%= entry.excerpt %>... <a href="/entree/<%= entry.id %>"><%= t('journal.read_more') %></a></p>
                    
                    <% if (locals.username) { %>
                        <div class="actions">
                            <a href="/entree/<%= entry.id %>/edit"><%= t('journal.edit') %></a>
                            <form action="/entree/<%= entry.id %>/delete" method="POST" 
                                  onsubmit="return confirm('<%= t('admin_page.delete_confirm', 'Voulez-vous vraiment supprimer cette entrée ?') %>');"
                                  style="display: inline;">
                                <button type="submit"><%= t('journal.delete') %></button>
                            </form>
                        </div>
                    <% } %>
                </div>
            </article>
        <% }); %>
    </div>
<% } else { %>
    <%# Affiche un message si aucun résultat n'est trouvé %>
    <p><%= t('search.no_results') %> "<%= query %>".</p>
<% } %>

<hr>
<nav>
    <a href="/journal"><%= t('journal.back_to_journal') %></a>
</nav>

<%- include('partials/footer') %>